{% extends 'base.html' %}
{% load staticfiles %}

{% block header %}
  <script src="{% static 'js/dashboard.js' %}"></script>
{% endblock %}

{% block content %}
  <h1 class="page-header">Dashboard</h1>

  <h2 class="sub-header">Websites</h2>
  {% if is_reload_scheduled %}
    <div class="alert alert-warning" role="alert">An apache reload has been scheduled. This may take upto one minute.</div>
  {% endif %}
  <div class="table-responsive">
    <table class="table table-striped">
      <thead>
        <tr>
          <th>Path</th>
          <th>Repo</th>
          <th>Revision</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td style="font-family: monospace">*:2223/</td>
          <td><a href="https://github.com/ammubhave/simadmin" target="_blank">https://github.com/ammubhave/simadmin</a></td>
          <td style="font-family: monospace">{{ simadmin_has }}</td>
          <td>
            <button type="button" class="btn btn-xs btn-primary" disabled>Sync</button>
            <button type="button" class="btn btn-xs btn-danger" disabled>Delete</button>
          </td>
        </tr>
        {% for website in websites %}
        <tr>
          <td style="font-family: monospace"><a href="http://simmons-dev.mit.edu/{{ website.path }}" target="_blank">{{ website.path }}</a></td>
          <td><a href="{{ website.repo }}" target="_blank">{{ website.repo }}</a></td>
          <td style="font-family: monospace">{{ website.has }}</td>
          <td>
            <button type="button" class="btn btn-xs btn-primary" onclick="post_to_get_response('/_/website/sync', {'id': '{{ website.name }}'});">Sync</button>
            <button type="button" class="btn btn-xs btn-danger" onclick="if(confirm('Are you sure you want to delete {{ website.name }}?')) { post_to_get_response('/_/website/remove', {'id': '{{ website.name }}'}); }">Delete</button>
          </td>
        </tr>
        {% endfor %}
        <tr>
          <td></td>
          <td><input type="text" style="width: 100%" class="form-control" id="new_website_repo" /></td>
          <td></td>
          <td><button type="button" class="btn btn-xs btn-success" onclick="post_to_get_response('/_/website/add', {'repo': $('#new_website_repo').val()});">Add</button></td>
        </tr>
      </tbody>
    </table>
  </div>
<pre id="status_window" style="background-color: black; height: 400px; color: white; padding: 10px; font-family: monospace">
Status Window
=============
</pre>
{% endblock %}
